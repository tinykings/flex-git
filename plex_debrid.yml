tasks:

  edits:
    metainfo_series: yes
    trakt_lookup: yes
    tvmaze_lookup: yes
    filesystem:
      path:
        - "/home/pi/torrents/shows/"
      recursive: yes
      retrieve: files
      regexp: '.*\.(avi|mkv|mp4)$'
    if:
      - trakt_series_content_rating == 'TV-MA': accept
      - "'anime' in trakt_genres": reject
    exec:
      on_output:
        for_accepted:
          - cp "{{location}}" "/home/pi/edits/{{series_name}}.{{series_id}}.mkv"
          - cleanvid -i "/home/pi/edits/{{series_name}}.{{series_id}}.mkv" -o "/home/pi/edits/{{series_name}}.{{series_id}}_clean.mkv" -w /home/pi/.flexget/swears.txt -e -p 0
          - if [ -f "/home/pi/edits/{{series_name}}.{{series_id}}_clean.mkv" ]; then rm "/home/pi/edits/{{series_name}}.{{series_id}}_clean.mkv"; else echo "nothing to clean"; fi
      on_exit:
        for_accepted:
          - rm "{{location}}"

  newmovies:
    delay: 12 hours
    imdb_lookup: yes
    trakt_list:
      username: giladg
      list: latest-releases
      type: movies
      strip_dates: yes
    imdb:
      min_score: 7
      min_votes: 5000
      reject_genres:
        - horror
      accept_mpaa_ratings:
        - G
        - PG
        - PG-13
    list_add:
      - trakt_list:
          username: profile
          account: profile
          list: watchlist
          type: movies

