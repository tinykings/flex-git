tasks:

  editShow:
    metainfo_series: yes
    trakt_lookup: yes
    tvmaze_lookup: yes
    tmdb_lookup: yes
    filesystem:
      path:
        - "/home/ryan/torrents/shows/"
      recursive: yes
      retrieve: files
      regexp: '.*\.(avi|mkv|mp4)$'
    if:
      - trakt_series_content_rating == 'TV-MA': accept
      - "'anime' in trakt_genres": reject
    exec:
      on_output:
        for_accepted:
          - /home/ryan/edits/subCheck.sh "{{location}}"
          - cleanvid -i "/home/ryan/edits/fake.mkv" -s "/home/ryan/edits/output.srt" -w /home/ryan/.flexget/swears.txt --plex-auto-skip-json "/home/ryan/plex_autoskip/{{filename}}.json" --plex-auto-skip-id tmdb://{{tmdb_id}}.{{series_season}}.{{series_episode}} -p 0
          - sed -i 's/volume/skip/g' "/home/ryan/plex_autoskip/{{filename}}.json"
          - rm /home/ryan/edits/*.srt

  editMovie:
    disable: seen
    tmdb_lookup: yes
    imdb_lookup: yes
    filesystem:
      path:
        - "/home/ryan/torrents/movies/"
      recursive: yes
      retrieve: files
      regexp: '.*\.(avi|mkv|mp4)$'
    if:
      - imdb_mpaa_rating == 'R': accept
    exec:
      on_output:
        for_accepted:
          # sub check
          - /home/ryan/edits/subCheck.sh "{{location}}"
          - cleanvid -i "/home/ryan/edits/fake.mkv" -s "/home/ryan/edits/output.srt" -w /home/ryan/.flexget/swears.txt --plex-auto-skip-json "/home/ryan/plex_autoskip/{{movie_name}}.json" --plex-auto-skip-id tmdb://{{tmdb_id}} -p 0
          - sed -i 's/volume/skip/g' "/home/ryan/plex_autoskip/{{filename}}.json"
          - rm /home/ryan/edits/*.srt
          # vidangel check
          - /home/ryan/edits/vaCheck.sh {{movie_name}} {{tmdb_id}} "/home/ryan/plex_autoskip/{{movie_name}}_va"
          - rm /home/ryan/edits/*.json


  newmovies:
    delay: 12 hours
    imdb_lookup: yes
    trakt_list:
      username: giladg
      list: latest-releases
      type: movies
      strip_dates: yes
    imdb:
      min_score: 7
      min_votes: 5000
      reject_genres:
        - horror
      accept_mpaa_ratings:
        - G
        - PG
        - PG-13
    list_add:
      - trakt_list:
          username: profile
          account: profile
          list: watchlist
          type: movies
